<!DOCTYPE html>
<html lang="en">

<head>
    <title>REGISTER</title>
    <link rel="stylesheet" href="./style.css">
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,600,700&display=swap" rel="stylesheet">
</head>

<body>
    <script>
        var hash = location.hash.replace(/_/, ' ').substr(1);
        var eventName = hash.split('-')[0];
        var eventDept = hash.split('-')[1];
    </script>
    <div id="loading" class="">Loading&#8230;</div>
    <div id='stars'></div>
    <div id='stars2'></div>
    <div id='stars3'></div>
    <h1 class="shadow" style="font-size: 3em;">
        <script>document.write(eventName)</script>
    </h1>

    <div
        style="width: 60%; margin: auto; border: 1.8px solid #dadada; box-shadow: inset 0 0 1em rgba(0, 170, 170, 0.5), 0 0 1em rgba(0, 170, 170, 0.5);">
        <input class='invisible' type="checkbox" id="chck1">
        <label
            style="display: flex;justify-content: center;padding: 1em;background: #2c3e50;font-weight: bold; color:  rgb(255, 136, 136) "
            for="chck1">REGISTER FORM</label>
        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="/__/firebase/6.3.3/firebase-app.js"></script>

        <script src="/__/firebase/6.3.3/firebase-database.js"></script>
        <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#reserved-urls -->

        <!-- Initialize Firebase -->
        <script src="/__/firebase/init.js"></script>
        <script>
            var config = {
                apiKey: "AIzaSyAUIgbQuHLe6WOK0FmbeOUw6azgtR3mpn0",
                authDomain: "techzeal.firebaseapp.com",
                databaseURL: "https://techzeal-e4bde.firebaseio.com/",
                storageBucket: "bucket.appspot.com"
            };
            if (!firebase.apps.length) {
                firebase.initializeApp(config);
            }
            function validateAndSubmit() {
                var form = document.forms["register"];
                var els = Object.values(form);
                els.pop();
                for (var i = 0; i < els.length; i++) {
                    if (!els[i].value) {
                        alert(els[i].name + ' cannot be empty!')
                        return false;
                    }
                }

                document.getElementById('loading').className = 'loading'

                var database = firebase.database();

                firebase.database().ref('users/' + new Date().getTime()).set({
                    name: form["Name"].value,
                    email: form["Email"].value,
                    year: form["Year"].value,
                    college: form["College"].value,
                    dept: form["Dept"].value,
                    mobile: form["Phone"].value,
                    eventName: eventName,
                    eventDept: eventDept
                }, function (error) {
                    if (error) {
                        alert('Sorry! You couldn\'t be registered. Please try again!');
                        form.reset();
                    } else {
                        alert('Registration Successful!');
                        form.reset();
                    }
                }).then(() => {
                    document.getElementById('loading').className = '';
                });
                return false;
            }
        </script>
        <form name="register" action="" method="POST" onsubmit="return validateAndSubmit()">
            <div class="tab-content shadow" style="font-size: 20px; max-height: 100vh; padding: 1em;">
                REGISTER NOW <br /> <br />
                NAME <br /> <br />
                <div class="col-3">
                    <input required name="Name" class="effect-13" type="text" placeholder="ENTER YOUR NAME">
                    <span class="focus-bg"></span>
                </div> <br />
                EMAIL <br /> <br />
                <div class="col-3">
                    <input required name="Email" class="effect-13" type="email" placeholder="ENTER YOUR EMAIL">
                    <span class="focus-bg"></span>
                </div> </br>
                PHONE <br /> <br />
                <div class="col-3">
                    <input required name="Phone" class="effect-13" type="number" placeholder="ENTER YOUR PHONE NO">
                    <span class="focus-bg"></span>
                </div> <br />
                YEAR <br /> <br />
                <div class="col-3">
                    <select name="Year">
                        <option value="1">
                            First year
                        </option>
                        <option value="2">
                            Second year
                        </option>
                        <option value="3">
                            Third year
                        </option>
                        <option value="4">
                            Fourth year
                        </option>
                    </select>
                    <span class="focus-bg"></span>
                </div> <br /> <br />
                DEPARTMENT <br /> <br />
                <div class="col-3">
                    <input required name="Dept" class="effect-13" type="text" placeholder="ENTER YOUR DEPARTMENT">
                    <span class="focus-bg"></span>
                </div> </br>
                COLLEGE NAME<br /> <br />
                <div class="col-3">
                    <input required name="College" class="effect-13" type="text" placeholder="ENTER YOUR COLLEGE NAME">
                    <span class="focus-bg"></span>
                </div> <br /> <br />
                <div class="pure-button fuller-button-dept red">
                    <button id='submit' type="submit">Register!</button>
                </div>
                </br>
            </div>
        </form>
    </div>
</body>

</html>